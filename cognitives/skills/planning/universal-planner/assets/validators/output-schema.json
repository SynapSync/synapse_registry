{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://synapsync.dev/schemas/universal-planner-output.json",
  "title": "Universal Planner Output Contract",
  "description": "Defines the expected output structure for universal-planner skill",
  "type": "object",
  "required": ["planning_dir", "mode", "project_name", "files"],
  "properties": {
    "planning_dir": {
      "type": "string",
      "description": "Absolute path to the planning directory",
      "pattern": "^/.*|^~.*",
      "examples": [
        "/Users/user/obsidian-vault/my-project/planning/feature-name",
        "~/obsidian-vault/my-project/planning/feature-name"
      ]
    },
    "mode": {
      "type": "string",
      "enum": ["NEW_PROJECT", "NEW_FEATURE", "REFACTOR", "BUG_FIX", "TECH_DEBT", "ARCHITECTURE"],
      "description": "Planning mode used to generate output"
    },
    "project_name": {
      "type": "string",
      "description": "Project name in kebab-case",
      "pattern": "^[a-z0-9]+(-[a-z0-9]+)*$",
      "examples": ["my-project", "feature-auth", "refactor-api-layer"]
    },
    "files": {
      "type": "object",
      "description": "Map of generated files with their absolute paths",
      "required": ["README.md"],
      "properties": {
        "README.md": {
          "type": "string",
          "description": "Path to project README"
        },
        "discovery/CONVENTIONS.md": {
          "type": "string",
          "description": "Path to conventions document (all modes except NEW_PROJECT)"
        },
        "analysis/ANALYSIS.md": {
          "type": "string",
          "description": "Path to analysis document (required for all modes)"
        },
        "planning/PLANNING.md": {
          "type": "string",
          "description": "Path to planning document (required for all modes)"
        },
        "execution/EXECUTION.md": {
          "type": "string",
          "description": "Path to execution plan (required for all modes)"
        },
        "sprints/PROGRESS.md": {
          "type": "string",
          "description": "Path to progress dashboard (required for all modes)"
        }
      },
      "additionalProperties": {
        "type": "string"
      }
    },
    "metadata": {
      "type": "object",
      "description": "Additional metadata about the planning session",
      "properties": {
        "created_at": {
          "type": "string",
          "format": "date-time",
          "description": "ISO 8601 timestamp of when planning was generated"
        },
        "skill_version": {
          "type": "string",
          "pattern": "^\\d+\\.\\d+(\\.\\d+)?$",
          "description": "Version of universal-planner that generated this output"
        },
        "total_files": {
          "type": "integer",
          "minimum": 1,
          "description": "Total number of files generated"
        },
        "estimated_duration": {
          "type": "string",
          "description": "Estimated project duration (e.g., '2 weeks', '3 months')"
        },
        "sprint_count": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of sprint plans generated"
        }
      }
    }
  },
  "allOf": [
    {
      "if": {
        "properties": {
          "mode": { "const": "NEW_PROJECT" }
        }
      },
      "then": {
        "properties": {
          "files": {
            "required": [
              "README.md",
              "requirements/problem-definition.md",
              "requirements/goals-and-metrics.md",
              "requirements/stakeholders-and-personas.md",
              "requirements/functional-requirements.md",
              "requirements/non-functional-requirements.md",
              "requirements/assumptions-and-constraints.md",
              "requirements/out-of-scope.md",
              "design/system-overview.md",
              "design/architecture-decisions.md",
              "design/high-level-architecture.md",
              "design/data-model.md",
              "design/core-flows.md",
              "design/non-functional-design.md",
              "analysis/ANALYSIS.md",
              "planning/PLANNING.md",
              "execution/EXECUTION.md",
              "sprints/PROGRESS.md"
            ]
          }
        }
      }
    },
    {
      "if": {
        "properties": {
          "mode": { "const": "ARCHITECTURE" }
        }
      },
      "then": {
        "properties": {
          "files": {
            "required": [
              "README.md",
              "discovery/CONVENTIONS.md",
              "design/system-overview.md",
              "design/architecture-decisions.md",
              "design/high-level-architecture.md",
              "design/data-model.md",
              "design/core-flows.md",
              "design/non-functional-design.md",
              "analysis/ANALYSIS.md",
              "planning/PLANNING.md",
              "execution/EXECUTION.md",
              "sprints/PROGRESS.md"
            ]
          }
        }
      }
    },
    {
      "if": {
        "properties": {
          "mode": {
            "enum": ["NEW_FEATURE", "REFACTOR", "BUG_FIX", "TECH_DEBT"]
          }
        }
      },
      "then": {
        "properties": {
          "files": {
            "required": [
              "README.md",
              "discovery/CONVENTIONS.md",
              "analysis/ANALYSIS.md",
              "planning/PLANNING.md",
              "execution/EXECUTION.md",
              "sprints/PROGRESS.md"
            ]
          }
        }
      }
    }
  ],
  "examples": [
    {
      "planning_dir": "~/obsidian-vault/my-project/planning/new-feature",
      "mode": "NEW_FEATURE",
      "project_name": "new-feature",
      "files": {
        "README.md": "~/obsidian-vault/my-project/planning/new-feature/README.md",
        "discovery/CONVENTIONS.md": "~/obsidian-vault/my-project/planning/new-feature/discovery/CONVENTIONS.md",
        "analysis/ANALYSIS.md": "~/obsidian-vault/my-project/planning/new-feature/analysis/ANALYSIS.md",
        "planning/PLANNING.md": "~/obsidian-vault/my-project/planning/new-feature/planning/PLANNING.md",
        "execution/EXECUTION.md": "~/obsidian-vault/my-project/planning/new-feature/execution/EXECUTION.md",
        "sprints/PROGRESS.md": "~/obsidian-vault/my-project/planning/new-feature/sprints/PROGRESS.md",
        "sprints/SPRINT-1-setup.md": "~/obsidian-vault/my-project/planning/new-feature/sprints/SPRINT-1-setup.md"
      },
      "metadata": {
        "created_at": "2026-02-12T10:30:00Z",
        "skill_version": "2.1.0",
        "total_files": 7,
        "estimated_duration": "2 weeks",
        "sprint_count": 1
      }
    },
    {
      "planning_dir": "~/obsidian-vault/my-project/planning/new-app",
      "mode": "NEW_PROJECT",
      "project_name": "new-app",
      "files": {
        "README.md": "~/obsidian-vault/my-project/planning/new-app/README.md",
        "requirements/problem-definition.md": "~/obsidian-vault/my-project/planning/new-app/requirements/problem-definition.md",
        "requirements/goals-and-metrics.md": "~/obsidian-vault/my-project/planning/new-app/requirements/goals-and-metrics.md",
        "requirements/stakeholders-and-personas.md": "~/obsidian-vault/my-project/planning/new-app/requirements/stakeholders-and-personas.md",
        "requirements/functional-requirements.md": "~/obsidian-vault/my-project/planning/new-app/requirements/functional-requirements.md",
        "requirements/non-functional-requirements.md": "~/obsidian-vault/my-project/planning/new-app/requirements/non-functional-requirements.md",
        "requirements/assumptions-and-constraints.md": "~/obsidian-vault/my-project/planning/new-app/requirements/assumptions-and-constraints.md",
        "requirements/out-of-scope.md": "~/obsidian-vault/my-project/planning/new-app/requirements/out-of-scope.md",
        "design/system-overview.md": "~/obsidian-vault/my-project/planning/new-app/design/system-overview.md",
        "design/architecture-decisions.md": "~/obsidian-vault/my-project/planning/new-app/design/architecture-decisions.md",
        "design/high-level-architecture.md": "~/obsidian-vault/my-project/planning/new-app/design/high-level-architecture.md",
        "design/data-model.md": "~/obsidian-vault/my-project/planning/new-app/design/data-model.md",
        "design/core-flows.md": "~/obsidian-vault/my-project/planning/new-app/design/core-flows.md",
        "design/non-functional-design.md": "~/obsidian-vault/my-project/planning/new-app/design/non-functional-design.md",
        "analysis/ANALYSIS.md": "~/obsidian-vault/my-project/planning/new-app/analysis/ANALYSIS.md",
        "planning/PLANNING.md": "~/obsidian-vault/my-project/planning/new-app/planning/PLANNING.md",
        "execution/EXECUTION.md": "~/obsidian-vault/my-project/planning/new-app/execution/EXECUTION.md",
        "sprints/PROGRESS.md": "~/obsidian-vault/my-project/planning/new-app/sprints/PROGRESS.md"
      },
      "metadata": {
        "created_at": "2026-02-12T10:30:00Z",
        "skill_version": "2.1.0",
        "total_files": 18,
        "estimated_duration": "3 months",
        "sprint_count": 0
      }
    }
  ]
}
